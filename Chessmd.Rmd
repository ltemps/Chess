---
title: "First Impressions"
subtitle: "The Impact of Opening Move on a Chess Match"
author: "Lauren Temple"
date: "12/2021"
output: 
  pdf_document: default
---
TODO:
- Choose a color for EDA graphs, keep consistent color for those variables
- replace the placeholder information
- write abstract
- write introduction
- choose graphs to show in EDA section and add description
- model
- results
- discussion
- conclusion

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning=FALSE, message=FALSE)
pacman::p_load(readr, readxl, tidyverse, plyr, dplyr, lmerTest, gvlma, ggplot2, plotly, gridExtra)
```

## Abstract

Chess is a strategy and tactic based board game played between two players. It is one of the world's most popular games and is played by millions of people worldwide. The opening move is a topic that has books devoted to it and names for each particular movement pattern. What can we learn from opening moves? Can we predict the length of the match? The number of total moves? Can we use player Elo rating to predict the opening move that will be used?

Raise the general question
State how I addressed it and what the overall results are

## Introduction

introduce chess and the question at hand

I use multilevel models to examine the affects that an opening move has on a chess match. This report aims to answer the following questions; does opening move have an affect on the total number of moves; does the opening move have an affect on the duration of the game; and does the Elo of the white player have an affect on opening move choice? 

## Methods

### Data Cleaning and Processing

The data set is published on [Kaggle: 15 Million Chess Games from Lichess (2013-2014)](https://www.kaggle.com/maca11/chess-games-from-lichess-20132014?select=Lichess_2013_2014_Complete.csv). This data set contains 14,918,230 observations, each representing a different chess match. I began by removing columns that were not of interest to my analysis. I then filtered the matches by time to only include those classified as bullet (<= 179s) or blitz (<= 479s), using dplyr. I kept only where both partner had a rating of at least 2000. This Elo rating is categorized as a strong expert and is in the highest tier. At this point in my data cleaning there existed 2,510 unique opening moves. I decided to simplify the opening move by keeping only the first segment of its description. For example if the opening move entry was "Scandinavian Defense: Modern Variation, Gipslis Variation" that entry would simply be "Scandinavian Defense". After simplifying the opening move there still remain 296 unique moves. I created a table (insert table number) to examine the frequency at which they occur and selected the top ten for analysis. The cleaned data set contains 162,937 observations of 8 variables.

Definition of columns:

| column names      | explanation |
| :--:              | :----- |
| WhiteElo          | Elo* of the player with white pieces|
| BlackElo          | Elo* of the player with black pieces |
| Winner            | Color of the winning pieces |
| Termination       | How the game ended, it can be: Normal, Time Forfeit, Abandon or Rules infraction |
| Year              | Year when the game was played |
| TimeControl       | Classification of the games based on the estimated duration of a game|
| Opening           | Opening Move Name|
| Number of Moves   | Number of moves of the game|

*Elo is a rating system that measures the relative strength of a player
** Time Control is calculated as InitialTime+ 40*Increment and has 

### Exploratory Data Analysis

```{r, include= FALSE}
source("Data_Wrangling.R")
```

```{r echo=FALSE, fig.height=4, fig.width= 10,fig.cap="caption of visualization"}
ggplot(Chess) + geom_bar(aes(x= Opening, y= ..count..)) +
  labs(title= "Opening move Frequency", 
       x= "Opening Move", y= "Frequency") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```
Figure 1 shows

```{r echo=FALSE, fig.height=4, fig.width= 10,fig.cap="caption of visualization"}
ggplot(Chess) + geom_col(aes(x= Opening, y= Number_of_Moves)) +
  labs(title= "Opening move & Number of Moves", 
       x= "Opening Move", y= "Number of Moves") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```
Figure 2 shows

```{r, echo=FALSE, fig.height=4, fig.width= 10,fig.cap="caption of visualization"}
ggplot(Chess, aes(x= WhiteElo, y= Number_of_Moves)) +
  geom_point(aes(color= Opening), alpha = 0.3) +
  labs(title= "Opening move & Number of Moves", 
       x= "White Elo Rating", y= "Number of Moves") +
  geom_smooth(aes(color= Opening), method = "lm", se=FALSE) + theme(legend.position="none")
```

### Model Fitting (whichever model works name it 'fit')


Does opening move have an affect on the total number of moves? 
Does the opening move have an affect on the TimeControl?
Does WhiteElo have an affect on opening move choice?

Does opening move have an affect on the number of moves?
Control for the timecontrol?
```{r, echo=FALSE}
m_2 <- lmer(Number_of_Moves ~ Opening + (1 | TimeControl) + 
              (1 | Opening:TimeControl), Chess)
confint(m_2)
coef(m_2)
summary(m_2)
```

```{r, echo=FALSE}
m_3 <- lmer(Number_of_Moves ~ Opening + (1 | WhiteElo) + 
              (1 | Opening:WhiteElo), Chess)
confint(m_3)
coef(m_3)
summary(m_3)
```

## Results

## Model Coefficients

## Discussion

issues with the model 

## Conclusion

summary of results

limitations

\newpage
## Citations

Elo Rating System - Chess Terms. (n.d.). Chess.Com. https://www.chess.com/terms/elo-rating-chess
Wikipedia contributors. (2021, December 2). Chess. Wikipedia. https://en.wikipedia.org/wiki/Chess

\newpage
## Appendix
### More EDA
```{r echo= FALSE, fig.cap= "Distribution plots for opening move, termination type, time control, White Elo rating, and number of moves"}
p1 <- ggplot(data = Chess) + 
  geom_bar(aes(x= Opening, y= ..count..)) +
  labs(title= "Distribution of Opening Moves", x= "Opening Moves", y= "Frequency") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

p2 <- ggplot(data = Chess) + 
  geom_bar(aes(x= Termination, y= ..count..)) +
  labs(title = "Distribution of Termination \n Category",x = "Termination Category", 
       y= "Frequency") + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))

p3 <- ggplot(data = Chess) + 
  geom_bar(aes(x= TimeControl, y= ..count..)) +
  labs(title = "Distribution of Time Control", x = "Time Control Category", y= "Frequency")

p4 <- ggplot(data = Chess) + 
  geom_bar(aes(x= Number_of_Moves, y= ..count..)) +
  labs(title = "Distribution of Number of Moves", x = "Number of Moves", y= "Frequency")

p5 <- ggplot(data = Chess) + 
  geom_bar(aes(x= WhiteElo, y= ..count..)) +
  labs(title = "Distribution of WhiteElo", x = "WhiteElo", y= "Frequency")

p1
p4
grid.arrange(p2, p3, ncol=2)
p5
```

\newpage
### Full Results
Random effects of model
```{r echo=FALSE}
ranef(fit)
```
Fixed effects of model
```{r echo=FALSE}
fixef(fit)
```
Coefficients of model
```{r echo=FALSE}
coef(fit)
```

